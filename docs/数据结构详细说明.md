# A股数据采集系统 - 数据结构详细说明

## 📊 系统概述

该系统基于 **AKShare** + **Supabase** + **Prisma** 构建的A股数据采集与管理系统，采集覆盖股票基础信息、实时行情、指数数据、资金流向、热门排行等多维度数据。

### 🎯 核心特性
- **数据源**: AKShare免费A股数据接口
- **数据库**: Supabase云端PostgreSQL
- **采集频率**: 支持历史数据批量采集和定时增量更新
- **数据范围**: 覆盖约5725只A股股票
- **更新时间**: 每日18:00自动采集最新数据

---

## 📋 数据表结构详解

### 1. 股票基础信息表 (StockBasic)

**表名**: `stock_basic`
**用途**: 存储A股所有股票的基础信息
**数据量**: 约5725条记录

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `stock_code` | String(10) | 股票代码(主键) | "000001", "600519" | 股票代码，6位数字格式 |
| `stock_name` | String(50) | 股票名称 | "平安银行", "贵州茅台" | 股票全称 |
| `exchange` | String(10) | 交易所 | "深交所", "上交所", "北交所" | 可用标签或图标区分 |
| `industry` | String(20) | 所属行业 | "银行", "白酒", "科技" | 行业分类标签 |
| `list_date` | Date | 上市日期 | "2023-01-15" | 格式化为YYYY-MM-DD |
| `total_share` | Decimal | 总股本(万股) | 1928374.56 | 以万股为单位显示 |
| `float_share` | Decimal | 流通股本(万股) | 1856234.78 | 以万股为单位显示 |
| `is_st` | Boolean | 是否ST股票 | true/false | 用红色标记ST股票 |
| `status` | String(10) | 交易状态 | "正常", "停牌" | 状态标签 |
| `update_time` | Timestamp | 更新时间 | "2024-06-20 18:00:00" | 数据时间戳 |

#### 前端开发建议
```javascript
// 示例数据结构
const stockBasic = {
  stock_code: "000001",
  stock_name: "平安银行", 
  exchange: "深交所",
  industry: "银行",
  list_date: "1991-04-03",
  total_share: 1928374.56,
  float_share: 1856234.78,
  is_st: false,
  status: "正常",
  update_time: "2024-06-20T18:00:00Z"
}
```

---

### 2. 日线行情数据表 (DailyQuote)

**表名**: `daily_quote`
**用途**: 存储所有股票的日K线数据
**数据量**: 历史数据千万级别，每日新增约5725条

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `id` | BigInt | 自增ID | 1234567 | 内部使用，前端无需展示 |
| `stock_code` | String(10) | 股票代码 | "000001" | 关联股票基础信息 |
| `trade_date` | Date | 交易日期 | "2024-06-20" | K线图X轴 |
| `open` | Decimal(10,2) | 开盘价(元) | 12.45 | 保留2位小数 |
| `high` | Decimal(10,2) | 最高价(元) | 12.88 | 保留2位小数 |
| `low` | Decimal(10,2) | 最低价(元) | 12.30 | 保留2位小数 |
| `close` | Decimal(10,2) | 收盘价(元) | 12.67 | 保留2位小数，重点显示 |
| `volume` | BigInt | 成交量(股) | 15678900 | 可格式化为万股/亿股 |
| `amount` | Decimal(20,2) | 成交额(元) | 198765432.10 | 可格式化为万元/亿元 |
| `amplitude` | Decimal(10,2) | 振幅(%) | 4.66 | 百分比显示 |
| `pct_chg` | Decimal(10,2) | 涨跌幅(%) | 2.34 | 红涨绿跌，百分比显示 |
| `change` | Decimal(10,2) | 涨跌额(元) | 0.29 | 红涨绿跌 |
| `turnover_rate` | Decimal(10,2) | 换手率(%) | 0.81 | 百分比显示 |
| `update_time` | Timestamp | 更新时间 | "2024-06-20 18:00:00" | 数据时间戳 |

#### 前端开发建议
```javascript
// 示例K线数据
const dailyQuote = {
  stock_code: "000001",
  trade_date: "2024-06-20",
  open: 12.45,
  high: 12.88,
  low: 12.30,
  close: 12.67,
  volume: 15678900,
  amount: 198765432.10,
  pct_chg: 2.34,
  change: 0.29,
  turnover_rate: 0.81
}

// 适用于图表库的数据格式转换
const candlestickData = {
  x: new Date(dailyQuote.trade_date),
  y: [dailyQuote.open, dailyQuote.high, dailyQuote.low, dailyQuote.close]
}
```

---

### 3. 指数数据表 (IndexData)

**表名**: `index_data`  
**用途**: 存储主要股指的历史数据
**覆盖指数**: 上证指数、深证成指、创业板指、沪深300、中证500

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `id` | BigInt | 自增ID | 1234567 | 内部使用 |
| `index_code` | String(10) | 指数代码 | "sh000001" | 指数标识 |
| `index_name` | String(50) | 指数名称 | "上证指数" | 指数全称 |
| `trade_date` | Date | 交易日期 | "2024-06-20" | 时间轴 |
| `open` | Decimal(10,2) | 开盘点位 | 3021.45 | 保留2位小数 |
| `high` | Decimal(10,2) | 最高点位 | 3045.67 | 保留2位小数 |
| `low` | Decimal(10,2) | 最低点位 | 3018.23 | 保留2位小数 |
| `close` | Decimal(10,2) | 收盘点位 | 3034.12 | 重点显示 |
| `change` | Decimal(10,2) | 涨跌点数 | 12.67 | 红涨绿跌 |
| `pct_chg` | Decimal(10,2) | 涨跌幅(%) | 0.42 | 百分比显示 |
| `volume` | BigInt | 成交量 | 15678900000 | 可格式化为亿股 |
| `amount` | Decimal(20,2) | 成交额(元) | 298765432100.00 | 可格式化为亿元 |

#### 指数代码对照表
| 指数代码 | 指数名称 | 市场意义 |
|----------|----------|----------|
| sh000001 | 上证指数 | 反映上海证券交易所整体走势 |
| sz399001 | 深证成指 | 反映深圳证券交易所成分股走势 |
| sz399006 | 创业板指 | 反映创业板市场走势 |
| sh000300 | 沪深300 | 反映沪深两市大盘股走势 |
| sh000905 | 中证500 | 反映中盘股走势 |

---

### 4. 交易日历表 (TradeCalendar)

**表名**: `trade_calendar`
**用途**: 存储交易日历信息
**数据范围**: 近5年交易日历

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `calendar_date` | Date | 日期(主键) | "2024-06-20" | 日历组件 |
| `is_trade_day` | Boolean | 是否交易日 | true/false | 工作日/节假日标识 |
| `week_day` | SmallInt | 星期几(0-6) | 3 | 周三，日历展示 |
| `is_holiday` | Boolean | 是否节假日 | false | 节假日标识 |
| `holiday_name` | String(50) | 节假日名称 | "端午节" | 节假日名称显示 |

#### 前端开发建议
```javascript
// 日历组件数据格式
const tradeDays = [
  {
    date: "2024-06-20",
    is_trade_day: true,
    is_holiday: false,
    week_day: 3,
    holiday_name: null
  },
  {
    date: "2024-06-21", 
    is_trade_day: false,
    is_holiday: true,
    week_day: 4,
    holiday_name: "端午节"
  }
]
```

---

### 5. 个股资金流排名表 (StockFundFlowRank)

**表名**: `stock_fund_flow_rank`
**用途**: 存储个股资金流向排名数据
**数据量**: 每日约5000+条记录

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `id` | BigInt | 自增ID | 1234567 | 内部使用 |
| `stock_code` | String(10) | 股票代码 | "000001" | 关联股票信息 |
| `stock_name` | String(50) | 股票名称 | "平安银行" | 股票名称 |
| `indicator` | String(10) | 周期指标 | "今日", "3日", "5日", "10日" | 时间周期选择器 |
| `trade_date` | Date | 交易日期 | "2024-06-20" | 数据日期 |
| `rank` | Integer | 排名序号 | 1, 2, 3... | 排行榜序号 |
| `latest_price` | Decimal(10,2) | 最新价(元) | 12.67 | 股价显示 |
| `pct_chg` | Decimal(10,4) | 涨跌幅(%) | 2.3456 | 百分比，红涨绿跌 |
| `main_net_inflow_amount` | Decimal(20,2) | 主力净流入-净额(元) | 12345678.90 | 格式化为万元/亿元 |
| `main_net_inflow_rate` | Decimal(10,4) | 主力净流入-净占比(%) | 5.2345 | 百分比显示 |
| `super_large_net_amount` | Decimal(20,2) | 超大单净流入-净额(元) | 8765432.10 | 格式化显示 |
| `super_large_net_rate` | Decimal(10,4) | 超大单净流入-净占比(%) | 3.1234 | 百分比显示 |
| `large_net_amount` | Decimal(20,2) | 大单净流入-净额(元) | 4123456.78 | 格式化显示 |
| `large_net_rate` | Decimal(10,4) | 大单净流入-净占比(%) | 2.0123 | 百分比显示 |
| `medium_net_amount` | Decimal(20,2) | 中单净流入-净额(元) | -1234567.89 | 负数显示为流出 |
| `medium_net_rate` | Decimal(10,4) | 中单净流入-净占比(%) | -1.5678 | 负数百分比 |
| `small_net_amount` | Decimal(20,2) | 小单净流入-净额(元) | -2345678.90 | 负数显示为流出 |
| `small_net_rate` | Decimal(10,4) | 小单净流入-净占比(%) | -2.8901 | 负数百分比 |

#### 资金流向分类说明
- **主力资金**: 超大单 + 大单资金合计
- **超大单**: 大于等于50万元的交易
- **大单**: 20万元-50万元的交易  
- **中单**: 5万元-20万元的交易
- **小单**: 小于5万元的交易

#### 前端开发建议
```javascript
// 资金流向数据示例
const fundFlowData = {
  stock_code: "000001",
  stock_name: "平安银行",
  indicator: "今日",
  rank: 1,
  latest_price: 12.67,
  pct_chg: 2.34,
  main_net_inflow_amount: 12345678.90, // 可格式化为 1234.57万元
  main_net_inflow_rate: 5.23,
  // 资金流向可视化数据
  flow_data: {
    inflow: [
      { name: "超大单", amount: 8765432.10, rate: 3.12 },
      { name: "大单", amount: 4123456.78, rate: 2.01 }
    ],
    outflow: [
      { name: "中单", amount: -1234567.89, rate: -1.57 },
      { name: "小单", amount: -2345678.90, rate: -2.89 }
    ]
  }
}
```

---

### 6. 沪深港通资金流向表 (HsgtFundFlow)

**表名**: `hsgt_fund_flow`
**用途**: 存储沪深港通北向/南向资金流向数据
**数据量**: 每日4条记录

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `id` | BigInt | 自增ID | 1234567 | 内部使用 |
| `trade_date` | Date | 交易日期 | "2024-06-20" | 数据日期 |
| `type` | String(10) | 类型 | "沪港通", "深港通" | 通道类型 |
| `sector` | String(20) | 板块 | "沪股通", "港股通(沪)", "深股通", "港股通(深)" | 具体板块 |
| `direction` | String(10) | 资金方向 | "北向", "南向" | 资金流向 |
| `trade_status` | SmallInt | 交易状态 | 3 | 3为收盘状态 |
| `net_buy_amount` | Decimal(20,2) | 成交净买额(亿元) | 23.45 | 以亿元为单位 |
| `net_inflow` | Decimal(20,2) | 资金净流入(亿元) | 18.67 | 以亿元为单位，正数为净流入 |
| `day_balance` | Decimal(20,2) | 当日资金余额(亿元) | 456.78 | 以亿元为单位 |
| `up_count` | Integer | 上涨数 | 123 | 上涨股票数量 |
| `flat_count` | Integer | 持平数 | 12 | 持平股票数量 |
| `down_count` | Integer | 下跌数 | 89 | 下跌股票数量 |
| `related_index` | String(20) | 相关指数 | "恒生指数" | 相关指数名称 |
| `index_pct_chg` | Decimal(10,4) | 指数涨跌幅(%) | 1.2345 | 百分比显示 |

#### 数据类型说明
| 类型 | 板块 | 说明 |
|------|------|------|
| 沪港通 | 沪股通 | 香港投资者买卖上海A股 |
| 沪港通 | 港股通(沪) | 内地投资者通过上海买卖香港股票 |
| 深港通 | 深股通 | 香港投资者买卖深圳A股 |
| 深港通 | 港股通(深) | 内地投资者通过深圳买卖香港股票 |

---

### 7. 股票人气榜表 (StockHotRank)

**表名**: `stock_hot_rank`
**用途**: 存储每日股票人气排行榜
**数据量**: 每日100条记录

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `id` | BigInt | 自增ID | 1234567 | 内部使用 |
| `trade_date` | Date | 交易日期 | "2024-06-20" | 数据日期 |
| `current_rank` | Integer | 当前排名 | 1, 2, 3... | 人气排行榜位次 |
| `stock_code` | String(10) | 股票代码 | "000001" | 股票代码 |
| `stock_name` | String(50) | 股票名称 | "平安银行" | 股票名称 |
| `latest_price` | Decimal(10,2) | 最新价(元) | 12.67 | 当前股价 |
| `change` | Decimal(10,2) | 涨跌额(元) | 0.29 | 涨跌金额 |
| `pct_chg` | Decimal(10,2) | 涨跌幅(%) | 2.34 | 百分比，红涨绿跌 |

---

### 8. 股票飙升榜表 (StockHotUp)

**表名**: `stock_hot_up`
**用途**: 存储每日股票飙升排行榜
**数据量**: 每日100条记录

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `id` | BigInt | 自增ID | 1234567 | 内部使用 |
| `trade_date` | Date | 交易日期 | "2024-06-20" | 数据日期 |
| `rank_change` | Integer | 排名变动 | +5, -3, 0 | 排名升降，用箭头表示 |
| `current_rank` | Integer | 当前排名 | 1, 2, 3... | 飙升榜位次 |
| `stock_code` | String(10) | 股票代码 | "000001" | 股票代码 |
| `stock_name` | String(50) | 股票名称 | "平安银行" | 股票名称 |
| `latest_price` | Decimal(10,2) | 最新价(元) | 12.67 | 当前股价 |
| `change` | Decimal(10,2) | 涨跌额(元) | 0.29 | 涨跌金额 |
| `pct_chg` | Decimal(10,2) | 涨跌幅(%) | 2.34 | 百分比，红涨绿跌 |

---

### 9. 股票新闻表 (StockNews)

**表名**: `stock_news`
**用途**: 存储股票相关新闻资讯
**数据来源**: 东方财富全球财经快讯
**数据量**: 每日约10-50条新闻

#### 字段说明
| 字段名 | 数据类型 | 说明 | 示例值 | 前端展示建议 |
|--------|----------|------|--------|-------------|
| `id` | BigInt | 自增ID | 1234567 | 内部使用 |
| `url` | String(500) | 新闻链接 | "https://finance.eastmoney.com/..." | 可点击跳转原文 |
| `tag` | String(100) | 新闻标题 | "A股三大指数集体收涨..." | 新闻标题 |
| `summary` | Text | 新闻摘要 | "今日A股市场表现..." | 新闻摘要内容 |
| `pub_time` | String(50) | 发布时间(原始) | "06-20 15:30" | 原始时间格式 |
| `pub_date_time` | Timestamp | 发布时间(标准) | "2024-06-20T15:30:00Z" | 标准时间格式 |
| `create_time` | Timestamp | 采集时间 | "2024-06-20T16:00:00Z" | 数据采集时间 |

#### 前端开发建议
```javascript
// 新闻数据示例
const newsData = {
  id: 1234567,
  url: "https://finance.eastmoney.com/news/1234567.html",
  tag: "A股三大指数集体收涨，创业板指涨超1%",
  summary: "今日A股市场表现强劲，三大指数全线收涨...",
  pub_time: "06-20 15:30",
  pub_date_time: "2024-06-20T15:30:00Z",
  create_time: "2024-06-20T16:00:00Z"
}

// 新闻列表组件建议显示
// 1. 标题(tag)作为主要内容
// 2. 发布时间格式化显示 
// 3. 摘要可折叠显示
// 4. 点击可跳转到原文链接
```

---

## 🔄 数据更新机制

### 采集频率
- **历史数据**: 一次性批量采集
- **增量数据**: 每日18:00自动采集当日数据
- **新闻数据**: 每20分钟采集一次
- **基础信息**: 每周日02:00更新股票基础信息

### 数据时效性
- **实时行情**: 收盘后数据
- **资金流向**: 收盘后统计数据
- **指数数据**: 可能延迟1-2小时更新
- **新闻资讯**: 准实时采集

---

## 🎨 前端展示页面建议

### 1. 首页概览
- **市场概况**: 主要指数走势图表
- **涨跌统计**: 上涨/下跌/平盘股票数量
- **资金流向**: 北向资金净流入情况
- **热门股票**: 人气榜前10名
- **最新新闻**: 最新5条财经快讯

### 2. 股票列表页
- **搜索功能**: 支持股票代码/名称搜索
- **筛选功能**: 按交易所、行业、ST状态筛选
- **排序功能**: 按涨跌幅、成交量、换手率排序
- **分页显示**: 支持分页浏览
- **实时更新**: 显示最新价格和涨跌幅

### 3. 股票详情页
- **基本信息**: 股票代码、名称、行业、上市时间等
- **实时行情**: 最新价、涨跌幅、成交量等关键指标
- **K线图表**: 支持日线/周线/月线切换
- **资金流向**: 主力资金流入流出情况
- **历史数据**: 可查询历史交易数据

### 4. 指数页面
- **指数列表**: 显示主要指数实时数据
- **指数图表**: 指数走势图
- **成分股**: 指数成分股排行

### 5. 资金流向页面
- **个股资金流排行**: 按不同周期显示资金流排名
- **北向资金**: 沪深港通资金流向统计
- **行业资金流**: 按行业统计资金流向

### 6. 排行榜页面
- **人气排行**: 股票人气排名
- **飙升排行**: 股票飙升排名
- **涨跌排行**: 按涨跌幅排序
- **成交排行**: 按成交量/成交额排序

### 7. 新闻资讯页面
- **新闻列表**: 最新财经新闻
- **搜索功能**: 支持关键词搜索新闻
- **分类筛选**: 按新闻类型筛选
- **详情查看**: 点击跳转到原文

---

## 📊 数据可视化建议

### 图表类型推荐
1. **K线图**: 使用 ECharts/TradingView 展示股票/指数走势
2. **柱状图**: 展示成交量、资金流向对比
3. **饼图**: 展示行业分布、资金流向占比
4. **折线图**: 展示趋势数据，如资金净流入趋势
5. **热力图**: 展示股票涨跌分布
6. **瀑布图**: 展示资金流向层级关系

### 颜色规范
- **涨**: #ff4d4f (红色)
- **跌**: #52c41a (绿色)  
- **平**: #8c8c8c (灰色)
- **成交量**: #1890ff (蓝色)
- **主力资金**: #722ed1 (紫色)

---

## 🔗 API接口设计建议

### RESTful API规范
```javascript
// 获取股票基础信息
GET /api/stocks?page=1&size=20&exchange=深交所&industry=银行

// 获取股票历史行情
GET /api/stocks/{stock_code}/quotes?start_date=2024-01-01&end_date=2024-06-20

// 获取指数数据
GET /api/indexes?date=2024-06-20

// 获取资金流向排行
GET /api/fund-flow-rank?indicator=今日&page=1&size=50

// 获取新闻列表
GET /api/news?page=1&size=20&keyword=A股

// 获取排行榜数据
GET /api/rankings/{type}?date=2024-06-20  // type: hot-rank, hot-up
```

### 响应数据格式
```javascript
{
  "code": 200,
  "message": "success", 
  "data": {
    "list": [...],
    "total": 5725,
    "page": 1,
    "size": 20,
    "pages": 287
  },
  "timestamp": "2024-06-20T18:00:00Z"
}
```

---

## 💡 性能优化建议

### 前端优化
1. **虚拟滚动**: 大数据量列表使用虚拟滚动
2. **懒加载**: 图片和图表按需加载
3. **缓存策略**: 基础数据使用浏览器缓存
4. **防抖节流**: 搜索和筛选功能使用防抖
5. **数据分页**: 避免一次性加载大量数据

---

## 🛠️ 技术栈推荐

### 前端技术栈
- **框架**: Nextjs15+
- **状态管理**: Redux/Vuex/Pinia
- **UI组件库**: shadcn/ui
- **图表库**: recharts
- **HTTP客户端**: Axios

---

这份详细的数据说明文档涵盖了系统中所有数据表的结构、字段含义、前端展示建议和技术实现方案，可以作为前端开发团队的重要参考文档。建议根据实际业务需求进行适当调整和扩展。 